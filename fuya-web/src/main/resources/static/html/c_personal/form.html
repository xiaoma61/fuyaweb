<!doctype html>
<html>
<head>
<meta charset="utf-8">
<script type="text/javascript" src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
<script src="../../js/laydate/laydate.js"></script>	
<link href="../../css/form.css" rel="stylesheet" type="text/css" />
<script src="../../js/form.js"></script>
<title>无标题文档</title>
</head>
<script  type="text/javascript">
	/*
$(function(){
    $.ajax({
        url:'../../data.json',
        type:'get',
        dataType:'json',
        success:function(data){
            //方法中传入的参数data为后台获取的数据
			success(data,10);
        }
    })
	
	function success(data,n){
			$("#tabletest .testtd").html('');
			$("#page").html('');
			$("p").html('');
			var num=n;
			var first=0;
			var last=first+num;
			var current=1;
			var count=Math.ceil(data.data.length/num);
			$("p").append("共"+data.data.length+"条"+"共"+count+"页");
			
			if(count!=1){
			var pageIcon=[];
			var pageN=[];
			pageIcon[0]='<span  class="pageIcon" selectPage="fir"><<</span>';
			pageIcon[1]='<span  class="pageIcon"  selectPage="pre"><</span>';
			pageIcon[2]='<span  class="pageIcon"  selectPage="next">></span>';
			pageIcon[3]='<span  class="pageIcon"  selectPage="las">>></span>';
			for(var j=1;j<=count;j++){	
				pageN[j-1]='<span class="page" selectPage="'+j+'">'+j+'</span>';
			 }
			$('#page').append(pageIcon[0]);
			$('#page').append(pageIcon[1]);
			if(count<3){
			for(var j=1;j<=count;j++)
				$('#page').append(pageN[j-1]);
			}
			else{
			for(var j=1;j<=3;j++)
				$('#page').append(pageN[j-1]); 
			}
			$('#page').append(pageIcon[2]);
			$('#page').append(pageIcon[3]);
			$('.page').eq(0).addClass('pageselect');
			}
			addformdata(data);
			
			function addpage(c){
			$("#page").html('');
			$('#page').append(pageIcon[0]);
			$('#page').append(pageIcon[1]);
			var be=parseInt(c)-1;
			var af=parseInt(c)+1;
			if(c==1){
			for(var j=1;j<=3;j++){	
			$('#page').append(pageN[j-1]);}
			$('.page').eq(0).addClass('pageselect');
			}
			else if(c==count){
			for(var j=count-2;j<=count;j++){	
			$('#page').append(pageN[j-1]);}
			$('.page').eq(2).addClass('pageselect');
			}
			else if(c!=1&&c!=count){
			for(var j=be;j<=af;j++){	
			$('#page').append(pageN[j-1]);}
			$('.page').eq(1).addClass('pageselect');
			}
			$('#page').append(pageIcon[2]);
			$('#page').append(pageIcon[3]);
			}

			function addformdata(data){
			for(var i=first;i<last;i++)
            {
                var tr; tr='<td>'+data.data[i].CN+'</td>'+'<td>'+data.data[i].JN+'</td>'+'<td>'+data.data[i].name+'</td>'+'<td>'+data.data[i].type+'</td>'+'<td>'+data.data[i].employer+'</td>'+'<td>'+data.data[i].startTime+'</td>'+'<td>'+data.data[i].SD+'</td>'+'<td>'+data.data[i].deposit+'</td>'+'<td>'+data.data[i].CG+'</td>'+'<td>'+data.data[i].ST+'</td>'+'<td><a href="#" class="che" code="'+data.data[i].CN+'">'+"查看"+'</a></td>'+'<td><a href="#" class="rev" code="'+data.data[i].CN+'">'+"修改"+'</a></td>'+'<td><a href="#" class="del" code="'+data.data[i].CN+'">'+"删除"+'</a></td>';
                $("#tabletest").append('<tr class="testtd">'+tr+'</tr>');
            }
			}
		
			
			$(document).on('click', 'span',function() {	
			var selectPage=$(this).attr('selectPage');
			$(".page").removeClass('pageselect');
			if(selectPage=="fir"||(selectPage=="pre"&&current==1))selectPage=1;
			if(selectPage=="las"||(selectPage=="next"&&current==count))selectPage=count;
			if(selectPage=="pre"&&current!=1)selectPage=parseInt(current)-1;
			if(selectPage=="next"&&current!=count)selectPage=parseInt(current)+1;
			if(count<=3)
				$('.page').eq(selectPage-1).addClass('pageselect');
			if(count>3)addpage(selectPage);
			current=selectPage;
			first=(selectPage-1)*num;
			last=first+num;
			$("#tabletest .testtd").html('');
			addformdata(data);	
			});
			
			$(document).on('click', '.del',function() {	
			var code = $(this).attr("code");
			$.ajax({
				url:"../../data.json",
				data:{c:code},
				type:"POST",
				dataType:"json",
				success: function(data){ 
				if(data.status==1)
				  {
					success(data,10);
				  } 
				  else
				  {
					alert("删除失败！"); 
				  }
					},
				error:function(){}
			})
			})
		
			$(document).on('click','.che',function(){
			var code=$(this).attr("code");
			$.ajax({
				url:"../../data.json",
				data:{c:code},
				type:"POST",
				dataType:"json",
				success: function(data){ 
					$("#see").css("display","block");
					$(".check_bottom").css("display","none");
					$(".check_top").css("display","block");
					for(var i=0;i<data.data.length;i++){
						if(data.data[i].CN==code){
							$("#CN").html(data.data[i].CN);
							$("#JN").html(data.data[i].JN);
							$("#nam").html(data.data[i].name);
							$("#type").html(data.data[i].type);
							$("#ST").html(data.data[i].ST);
							$("#EDC").html(data.data[i].CN);
							$("#ServiceBegin").html(data.data[i].CN);
							$("#ServiceDays").html(data.data[i].CN);
							$("#deposit").html(data.data[i].deposit);
							$("#price").html(data.data[i].CN);
							$("#remarks").html(data.data[i].CN);
							$("#state").html(data.data[i].CN);
							$("#sum").html(data.data[i].CN);
							$("#employer").html(data.data[i].employer);
							$("#area").html(data.data[i].CN);
							$("#address").html(data.data[i].CN);
							$("#number").html(data.data[i].CN);
					}
					}
					},
				error:function(){}
			})
			})
		
		$(document).on('click','.rev',function(){
			var code=$(this).attr("code");
			$.ajax({
				url:"../../data.json",
				data:{c:code},
				type:"POST",
				dataType:"json",
				success: function(data){ 
					$("#see").css("display","block");
					$(".check_bottom").css("display","block");
					$(".check_top").css("display","none");
					for(var i=0;i<$('.check_middle table td').length;i++)
            		{	
						if(i%2!=0&&$('.check_middle table td').eq(i-1).html()!="")
						{	
							$('.check_middle table td').eq(i).html('');
							$('.check_middle table td').eq(i).append('<input type="text" style="width:99%;height:100%" />');
						}
					}
					},
				error:function(){}
			})
		})		
	}
	
		$(document).on('click','#cancel',function(){
			$("#see").css("display","none");
			
		})
		$(document).on('click','#save',function(){
			$.ajax({
				url:"../../data.json",
				data:{
						a:$("#CN input").val(),
						b:$("#JN input").val(),
						c:$("#nam input").val(),
						d:$("#type input").val(),
						e:$("#ST input").val(),
						f:$("#EDC input").val(),
						g:$("#ServiceBegin input").val(),
						h:$("#ServiceDays input").val(),
						i:$("#deposit input").val(),
						j:$("#price input").val(),
						k:$("#remarks input").val(),
						l:$("#state input").val(),
						m:$("#sum input").val(),
						n:$("#employer input").val(),
						o:$("#area input").val(),
						p:$("#address input").val(),
						q:$("#number input").val()
				},
				type:"POST",
				dataType:"json",
				success: function(data){
						success(data,10);
						alert("保存成功！");
						$("#see").css("display","none");
					},
				error:function(){}
			})
		})
	
	
	$("#search_time").click(function(){
		var ti =$("#time").val();
			$.ajax({
				url:"../../data.json",
				data:{t:ti},
				type:"POST",
				dataType:"json",
				success: function(data){ 
				if(data.status==1)
				  {
					success(data,10);
				  } 
				  else
				  {
					alert("搜索失败！"); 
				  }
					},
				error:function(){}
			})
	})
	
	$("#search_name").click(function(){
		var na=$("#name").val();
			$.ajax({
				url:"../../data.json",
				data:{n:na},
				type:"POST",
				dataType:"json",
				success: function(data){ 
				if(data.status==1)
				  {
					success(data,10);
				  } 
				  else
				  {
					alert("搜索失败！"); 
				  }
					},
				error:function(){}
			})
	})
		$(document).on('focus','#name',function(){	
			if ($("#name").val()!="") {
				$('.hide').css("display","block");
				$('.hide').css("top",$('#name').offset().top+30);
				$('.hide').css("left",$('#name').offset().left);
			}
		})
		$('#name').bind('input propertychange', function() {
			$.ajax({
				url:"../../data.json",
				data:{c:$("#name").val()},
				type:"POST",
				dataType:"json",
				success: function(data){ 
					$('.hide ul').html("");
					for(var i=0; i<5;i++){					
						var d;
						d='<li>李蕴蕴'+i+'</li>';
						$('.hide ul').append(d);
					}
						$('.hide').css("display","block");
						$('.hide').css("top",$('#name').offset().top+30);
						$('.hide').css("left",$('#name').offset().left);
					},
				error:function(){}
			})
		});
	
		$(document).on('click','.hide ul>li',function(){
			$('#name').val($(this).html());
			$("#search_name").click();
			
		})
	$(document).click(function(){
		$('.hide').css("display","none");

	});
	$("#name").click(function(event){
	event.stopPropagation();

	}); 

})*/
  
setTimeout(laydate.render({elem: '#time'}),1000);
</script>
<body>
			  <div class="form">
			  	<div class="form_top">订单管理</div>
				 <hr>
				<div class="form_search"><div class="form_search_item">开始时间：<input type="text" id="time" ><input value="搜索" type="button" id="search_time"></div>
				  						 <div class="form_search_item">员工名称：<input type="text" id="name" ><input value="搜索" type="button" id="search_name"></div>
				  </div>
			  </div>
	<p id="num_show"></p>
	<div style="width: 100%;height: 600px">
	<table class="table table-bordered" id="tabletest">
    <tr>
        <th>合同号</th>
        <th>工号</th>
        <th>员工名称</th>
        <th>类型</th>
        <th>雇主</th>
        <th>开始时间</th>
        <th>服务天数</th>
        <th>定金</th>
        <th>合约金</th>
        <th>签订时间</th>
        <th colspan="3" width="120px">操作</th>
    </tr>
	
 </table></div>
		<div class="pagearea"><div id="page" style="top:0;left:0"></div></div>
<div class="check" id="see">
	<div class="check_top"><img src="../../img/close.png" width="30" alt="" style="cursor: pointer" onclick = "document.getElementById('see').style.display='none'"/></div>
	<div class="check_middle">
	<table>
		<th colspan="8">服务单</th>
		<tr><td>合同号</td><td id="CN"></td><td>工号</td><td id="JN"></td><td>员工名称</td><td id="nam"></td><td>类型</td><td id="type"></td></tr>
		<tr><td>签订时间</td><td id="ST"></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>
		</table>
	<table>
		<th colspan="8">服务内容</th>
		<tr><td>预产期</td><td id="EDC"></td><td>服务开始</td><td id="ServiceBegin"></td><td>服务天数</td><td id="ServiceDays"></td><td>定金</td><td id="deposit"></td></tr>
		<tr><td>服务价格</td><td id="price"></td><td>其他备注</td><td id="remarks"></td><td>完成状态</td><td id="state"></td><td>金额</td><td id="sum"></td></tr>
		</table>
	<table>
		<th colspan="8">户主信息</th>
		<tr><td>姓名</td><td id="employer"></td><td>所在地区</td><td id="area"></td><td>详细地址</td><td id="address"></td><td>手机号码</td><td id="number"></td></tr>
		</table>
	</div>
	<div class="check_bottom"><input value="保存" type="button" id="save"><input value="取消" type="button" id="cancel"></div>
</div>
	<div class="hide"><ul></ul></div>
</body>

</html>
